<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Palm Capture - Hand Positioning Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
            max-width: 800px;
            width: 90%;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .subtitle {
            font-size: 1.2rem;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        .camera-container {
            position: relative;
            display: inline-block;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
        }

        #video {
            width: 100%;
            max-width: 640px;
            height: auto;
            display: block;
            transform: scaleX(-1); /* Mirror effect */
        }

        .hand-guide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10;
        }

         .palm-svg {
             position: absolute;
             top: 50%;
             left: 30%;
             transform: translate(-50%, -50%);
             width: 35%;
             height: 70%;
             pointer-events: none;
             z-index: 10;
         }

         .palm-outline {
             animation: pulse 2s infinite;
         }


        .instructions {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }

        .instructions h3 {
            margin-bottom: 15px;
            color: #4CAF50;
        }

        .instructions ul {
            list-style: none;
            padding-left: 0;
        }

        .instructions li {
            margin: 10px 0;
            padding-left: 25px;
            position: relative;
        }

        .instructions li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: #4CAF50;
            font-weight: bold;
        }

        .status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
        }

        .status.ready {
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid #4CAF50;
            color: #4CAF50;
        }

        .status.error {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid #f44336;
            color: #f44336;
        }

        .controls {
            margin-top: 20px;
        }

        button {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1rem;
            border-radius: 25px;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        button:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .capture-btn {
            background: linear-gradient(45deg, #FF6B6B, #ee5a52);
        }

        .capture-btn:hover {
            background: linear-gradient(45deg, #ee5a52, #e74c3c);
        }

        .hidden {
            display: none;
        }


        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            button {
                padding: 12px 24px;
                font-size: 1rem;
                margin: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🤖 Palm Capture</h1>
        <p class="subtitle">Position your hand within the guide for optimal palm recognition</p>
        
        <div class="camera-container">
            <video id="video" autoplay muted playsinline></video>
             <div class="hand-guide">
                 <svg class="palm-svg" viewBox="0 0 316.8 430.41" preserveAspectRatio="xMidYMid meet">
                     <defs>
                         <filter id="glow">
                             <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                             <feMerge> 
                                 <feMergeNode in="coloredBlur"/>
                                 <feMergeNode in="SourceGraphic"/>
                             </feMerge>
                         </filter>
                     </defs>
                     
                     <path d="m293.12 154.31c-1.187-0.007-2.4908 0.14375-3.9062 0.46875-1.654 0.381-5.9352 3.7758-7.1562 5.7188-5.857 9.331-3.3628 32.779-3.5938 47.281 0.39025 15.233 2.9204 30.087 0.71875 44.438-5.7953 18.424 6.6761 79.039-10.719 55.906-3.865-13.098-3.7128-26.528-6.4688-39.438-2.313-10.837-7.553-18.441-10.75-29.375-3.253-11.125-4.0165-23.033-6.4375-36.531-2.5845-11.757-4.192-30.66-16.469-30.094-4.235 0.313-11.087 7.5565-12.906 12.188-2.338 5.955-2.7642 15.3-2.1562 24.344 0.506 7.548 2.6182 16.95 5.0312 26.531 2.226 8.834 2.6592 18.112 4.2812 27.219 1.958 11.007 3.6798 24.304 6.4688 35.844 1.106 4.581 1.4818 10.123 2.8438 16.469 1.735 8.072 3.9748 15.122-4.2812 17.906-9.868-4.702-13.419-16.71-17.473-27.228-4.0209-6.8333-15.709-23.025-19.808-31.522-5.5156-10.571-9.433-34.282-20.062-34.406-10.618 0.127-13.053 15.803-10.75 29.375 2.9086 13.013 10.359 23.442 15.781 34.406 7.894 15.721 15.691 34.516 24.344 50.875-0.27973 24.311 3.3662 45.243 5.75 68.062 1.189 9.402 3.8988 21.991 5.7188 32.25 4.8748 20.737 11.765 41.04 16.623 61.234 1.8913 7.8614 7.4745 15.706 8.511 23.553 0.49491 3.747 0.86513 7.4946 1.0846 11.245 0.291 4.541 0.13202 26.932 0.64102 31.6 2.7381 0.60062 2.6746 0.73178 4.3902 0.77474 1.344-12.563-0.56775-32.846-0.71875-44.562-1.5202-7.0776-7.273-14.302-9.1449-21.59-7.3446-28.597-16.522-58.18-20.668-83.753-0.826-5.373-1.4532-9.7765-2.1562-17.188-1.7211-16.896-6.8855-33.727-5.3125-49.594l-1.0938-13.5c-0.0109 0.01-0.0204 0.0215-0.0312 0.0312-2.315-5.895-5.7368-11.104-8.5938-17.188-2.664-5.674-4.2822-12.188-7.1562-18.625-6.6482-6.9826-8.3089-16.538-12.188-23.656-7.3226-9.9401-13.434-26.327-12.188-37.25 0.613-4.46 2.1814-11.269 5-12.188 2.8402-0.50157 4.2424 0.49634 5.75 1.4375 4.059 5.17 5.495 11.468 7.875 17.906 2.651 7.18 5.8822 16.75 10.031 22.938 5.1781 6.8446 9.7482 13.941 14.263 20.594 4.324 6.734 6.7994 14.572 10.83 21.688 1.192 2.1023 3.0563 3.4189 4.1562 5.375 9.0863 2.9243 11.891 1.7205 16.625-5.4062 0.362-14.783-7.3795-31.402-9.3125-50.156-1.2274-10.367-3.1456-19.472-4.3125-27.938-0.20887-11.874-3.267-19.981-5-30.812-0.918-5.314-3.398-14.044-2.875-21.5 0.567-8.118 5.351-21.686 13.625-20.781 4.803 0.526 6.009 5.2872 7.1174 9.3514 3.599 14.671 4.8939 27.899 7.9139 41.524 2.8767 11.755 4.8374 20.948 8.5938 28.656 1.987 4.551 5.2518 11.769 6.4688 19.375 2.0606 12.892 2.1181 25.7 7.875 37.938 0.004 0.009-0.004 0.0226 0 0.0312h0.1875c6.0305 4.5999 10.519 3.3961 12.719-2.1562 4.759-16.692-2.0885-41.966 3.5625-60.188 2.2701-11.357-0.80138-43.253-1.4375-65.938-0.26546-9.4663-1.1262-18.122 3.5938-25.062 12.967-8.424 19.108 7.4128 20.781 19.344 1.974 14.08 0.81525 30.2 2.1562 46.562 0.339 4.108 1.6302 8.2215 2.1562 12.188 0.573 4.313 1.522 7.9995 2.125 12.188 2.9867 20.715-3.1271 42.028 0.6875 60 6.5388 24.952 23.743-22.153 26.562-29.906 5.219-12.997 11.593-26.931 16.469-39.406 1.469-3.844 2.6248-7.6298 3.5938-11.469 2.8923-12.511 8.8459-35.173 19.344-39.406 8.092-0.758 11.395 3.1538 10.031 16.469-1.543 14.897-7.9702 31.998-10.781 48-1.0999 10.395-4.4316 19.755-7.1562 29.375-4.198 12.434-13.396 28.433-15.062 43-1.1686 27.23 0.97779 54.387 8.4062 75.562 7.8574 4.3914 13.184-1.8571 18.125-6.4688 3.185-2.94 5.8708-6.4565 8.5938-9.3125 6.367-6.681 12.485-11.41 17.094-17.906 4.1315-8.2934 10.768-13.988 18.031-18.625 7.211-4.657 12.308-7.127 20.781-7.875 6.6039-1.8383 11.742 0.8728 18.625 2.125 1.872 1.525 3.3758 2.0725 3.5938 4.3125 0.5 5.127-4.7832 6.0317-10.031 9.0357-18.749 12.648-36.516 28.751-48.031 46.839-2.078 12.971-7.6342 22.472-15.031 30.125-1.521 2.229-9.1468 8.717-10.969 10-9.633 15.924-13.071 23.526-22 40.156-20.587 12.661-21.009 51.245-11.281 75.656 1.017 9.016 5.303 17.38 9.125 22.938 1.6772-0.0166 1.6044-0.0816 4.0694-0.0893-1.1148-4.9983-8.0166-19.21-8.3819-25.004-1.901-18.222-10.225-38.084-2.125-55.607 2.536-5.095 9.184-10.12 12.875-15.031 6.5238-11.81 15.457-26.08 19.375-37.268 6.121-9.845 17.569-14.621 22.906-25.094 2.111-4.142 1.8648-9.0288 3.5938-13.594 4.3874-8.0897 11.818-18.59 17.906-25.094 13.8-12.226 29.902-23.148 43-33.656-0.514-12.861-12.463-14.285-24.344-15.781-11.793 0.95887-19.991 4.576-29.375 10.75-8.335 5.464-11.206 11.972-17.219 20.062-7.361 9.904-18.129 17.421-26.626 27.299-3.201 0.381-3.2397 1.2434-7.5447 0.52237-5.6205-23.837-7.8823-36.767-8.1102-62.508 0.34-3.3119 0.7615-8.9524 1.0848-12.174 9.9765-24.711 16.995-41.713 21.134-65.201 6.8033-16.252 21.594-67.025 0.71875-70.938-10.983-0.51417-18.276 11.075-22.219 19.344-5.169 11.194-5.5672 25.369-10.031 37.25-1.171 3.119-3.0938 5.3818-4.4688 8.5938-4.5822 9.475-26.072 67.599-29.406 61.25-4.918-11.713 0.79082-37.304-0.53125-55.5-0.407-5.603-2.0008-11.55-2.8438-17.219-3.141-21.142-3.6445-67.742-6.935-71.705-3.2438-5.1039-7.3808-13.963-15.69-14.014z"
                           fill="none" 
                           stroke="rgba(0, 255, 0, 0.8)" 
                           stroke-width="3" 
                           stroke-dasharray="8,4"
                           filter="url(#glow)"
                           class="palm-outline"/>
                 </svg>
             </div>
        </div>
        
        <div id="status" class="status ready">
            📷 Camera ready - Position your hand within the green outline
        </div>
        
        <div class="instructions">
            <h3>📋 Hand Positioning Instructions</h3>
            <ul>
                <li>Place your palm flat and centered within the green outline</li>
                <li>Keep your fingers spread naturally apart</li>
                <li>Ensure all fingers are visible and not cut off</li>
                <li>Keep your hand steady and well-lit</li>
                <li>Position your wrist at the bottom of the outline</li>
                <li>Make sure your palm faces the camera directly</li>
            </ul>
        </div>
        
        <div class="controls">
            <button id="startBtn" onclick="startCamera()">Start Camera</button>
            <button id="captureBtn" class="capture-btn" onclick="captureImage()" disabled>Capture Palm</button>
            <button id="stopBtn" onclick="stopCamera()" disabled>Stop Camera</button>
        </div>
    </div>

    <script>
        let stream = null;
        let video = document.getElementById('video');
        let status = document.getElementById('status');
        let startBtn = document.getElementById('startBtn');
        let captureBtn = document.getElementById('captureBtn');
        let stopBtn = document.getElementById('stopBtn');

        async function startCamera() {
            try {
                status.textContent = '🔄 Starting camera...';
                status.className = 'status';
                
                stream = await navigator.mediaDevices.getUserMedia({
                    video: {
                        width: { ideal: 1280 },
                        height: { ideal: 720 },
                        facingMode: 'user' // Front camera
                    }
                });
                
                video.srcObject = stream;
                
                video.onloadedmetadata = () => {
                    status.textContent = '📷 Camera ready - Position your hand within the green outline';
                    status.className = 'status ready';
                    startBtn.disabled = true;
                    captureBtn.disabled = false;
                    stopBtn.disabled = false;
                };
                
            } catch (error) {
                console.error('Error accessing camera:', error);
                status.textContent = '❌ Camera access denied or not available';
                status.className = 'status error';
                startBtn.disabled = false;
            }
        }

        function stopCamera() {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
                stream = null;
                video.srcObject = null;
                
                status.textContent = '📷 Camera stopped';
                status.className = 'status';
                startBtn.disabled = false;
                captureBtn.disabled = true;
                stopBtn.disabled = true;
            }
        }

        function captureImage() {
            if (!stream) {
                status.textContent = '❌ Camera not started';
                status.className = 'status error';
                return;
            }
            
            // Create canvas to capture the image
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            
            // Set canvas size to match video
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            
            // Draw the video frame to canvas (mirrored)
            context.scale(-1, 1);
            context.drawImage(video, -canvas.width, 0, canvas.width, canvas.height);
            
            // Convert to blob
            canvas.toBlob((blob) => {
                // Create download link
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `palm_capture_${new Date().getTime()}.jpg`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                status.textContent = '✅ Palm image captured and downloaded!';
                status.className = 'status ready';
                
                // Reset status after 3 seconds
                setTimeout(() => {
                    status.textContent = '📷 Camera ready - Position your hand within the green outline';
                    status.className = 'status ready';
                }, 3000);
                
            }, 'image/jpeg', 0.9);
        }

        // Auto-start camera when page loads
        window.addEventListener('load', () => {
            startCamera();
        });

        // Handle page visibility changes
        document.addEventListener('visibilitychange', () => {
            if (document.hidden && stream) {
                // Page is hidden, stop camera to save resources
                stopCamera();
            } else if (!document.hidden && !stream) {
                // Page is visible again, restart camera
                startCamera();
            }
        });

        // Handle window resize
        window.addEventListener('resize', () => {
            // Adjust guide positioning if needed
            const video = document.getElementById('video');
            const guide = document.querySelector('.hand-outline');
            
            if (video && guide) {
                // Guide will automatically adjust due to percentage positioning
            }
        });
    </script>
</body>
</html>
